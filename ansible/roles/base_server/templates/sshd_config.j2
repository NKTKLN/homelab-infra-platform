# Managed by Ansible - do not edit manually.
# Hardened SSH configuration for all servers.

Port {{ ssh_port }}
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding no

# Required for file transfers (sftp/scp)
Subsystem sftp internal-sftp

# Restrict SSH access to specific users only.
AllowUsers {% for user in ssh_allowed_users %}{{ user }} {% endfor %}

ClientAliveInterval 300
ClientAliveCountMax 2
PermitEmptyPasswords no
AllowAgentForwarding yes
AllowTcpForwarding yes

# Limit algorithms to modern, secure options.
KexAlgorithms { % for alg in ssh_kex_algorithms %}{{ alg }} {% endfor %}
Ciphers { % for cipher in ssh_ciphers %}{{ cipher }} {% endfor %}
MACs { % for mac in ssh_macs %}{{ mac }} {% endfor %}

LoginGraceTime 30
MaxAuthTries 5
